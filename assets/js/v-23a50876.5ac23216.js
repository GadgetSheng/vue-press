"use strict";(self.webpackChunkbfe_lessons=self.webpackChunkbfe_lessons||[]).push([[503],{7654:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-23a50876",path:"/packager/webpack.html",title:"学习webpack",lang:"en-US",frontmatter:{lastUpdated:!1},excerpt:"",headers:[{level:2,title:"Original",slug:"original",children:[{level:3,title:"Concepts",slug:"concepts",children:[]},{level:3,title:"Entry",slug:"entry",children:[]},{level:3,title:"Output",slug:"output",children:[]},{level:3,title:"Plugins",slug:"plugins",children:[]},{level:3,title:"Mode",slug:"mode",children:[]},{level:3,title:"Browser Compatibility",slug:"browser-compatibility",children:[]},{level:3,title:"Scenarios",slug:"scenarios",children:[]},{level:3,title:"Multiple Entry Points",slug:"multiple-entry-points",children:[]}]},{level:2,title:"Webpack内容综述",slug:"webpack内容综述",children:[{level:3,title:"01 webpack与构建发展简史",slug:"_01-webpack与构建发展简史",children:[]},{level:3,title:"02 webpack基础用法",slug:"_02-webpack基础用法",children:[]},{level:3,title:"03 webpack进阶用法",slug:"_03-webpack进阶用法",children:[]},{level:3,title:"04 编写可维护的webpack构建配置",slug:"_04-编写可维护的webpack构建配置",children:[]},{level:3,title:"05 Webpack构建速度和体积优化策略",slug:"_05-webpack构建速度和体积优化策略",children:[]},{level:3,title:"06 通过源码掌握webpack打包原理",slug:"_06-通过源码掌握webpack打包原理",children:[]}]}],filePathRelative:"packager/webpack.md",git:{updatedTime:1636906732e3}}},7410:(n,s,a)=>{a.r(s),a.d(s,{default:()=>Vo});var e=a(6252),l=a(744);const t=(0,e._)("h1",{id:"学习webpack",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#学习webpack","aria-hidden":"true"},"#"),(0,e.Uk)(" 学习webpack")],-1),o={class:"table-of-contents"},p=(0,e.Uk)("Original"),c=(0,e.Uk)("Concepts"),u=(0,e.Uk)("Entry"),_=(0,e.Uk)("Output"),i=(0,e.Uk)("Plugins"),r=(0,e.Uk)("Mode"),k=(0,e.Uk)("Browser Compatibility"),b=(0,e.Uk)("Scenarios"),m=(0,e.Uk)("Multiple Entry Points"),d=(0,e.Uk)("Webpack内容综述"),U=(0,e.Uk)("01 webpack与构建发展简史"),g=(0,e.Uk)("02 webpack基础用法"),w=(0,e.Uk)("03 webpack进阶用法"),h=(0,e.Uk)("04 编写可维护的webpack构建配置"),v=(0,e.Uk)("05 Webpack构建速度和体积优化策略"),y=(0,e.Uk)("06 通过源码掌握webpack打包原理"),f=(0,e._)("h2",{id:"original",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#original","aria-hidden":"true"},"#"),(0,e.Uk)(" Original")],-1),x=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"官方原文"),(0,e._)("h3",{id:"concepts",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#concepts","aria-hidden":"true"},"#"),(0,e.Uk)(" Concepts")]),(0,e._)("p",null,[(0,e.Uk)("webpack is a "),(0,e._)("strong",null,"static"),(0,e.Uk)(" module bundler for modern JavaScript application")]),(0,e._)("p",null,[(0,e.Uk)("it internally builds a ["),(0,e._)("code",null,"dependency graph"),(0,e.Uk)("] from one or more entry points and then combines every module your project needs into one or more bundles, which are static assets to serve your content from.")]),(0,e._)("p",null,"Core concepts:"),(0,e._)("ul",null,[(0,e._)("li",null,"Entry"),(0,e._)("li",null,"Output"),(0,e._)("li",null,"Loaders"),(0,e._)("li",null,"Plugins"),(0,e._)("li",null,"Mode"),(0,e._)("li",null,"Browser Compatiblity")]),(0,e._)("p",null,"一期目标问题"),(0,e._)("ul",null,[(0,e._)("li",null,"Manually Bundling an Application"),(0,e._)("li",null,"Live Coding a Simple Module Bundler"),(0,e._)("li",null,"Detailed Explaination of a Simple Module Bundler")]),(0,e._)("h3",{id:"entry",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#entry","aria-hidden":"true"},"#"),(0,e.Uk)(" Entry")]),(0,e._)("p",null,[(0,e.Uk)("entry point = which module webpack begin building out its internal "),(0,e._)("strong",null,"dependency graph"),(0,e.Uk)(". figure out depends on(directly or indirectly).")]),(0,e._)("p",null,[(0,e._)("code",null,"./src/index.js")]),(0,e._)("h3",{id:"output",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#output","aria-hidden":"true"},"#"),(0,e.Uk)(" Output")]),(0,e._)("p",null,[(0,e.Uk)("emit the bundles and specific the names of these files. "),(0,e._)("code",null,"./dist/main.js"),(0,e.Uk)(" { path, filename }")]),(0,e._)("h3",{id:"plugins",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#plugins","aria-hidden":"true"},"#"),(0,e.Uk)(" Plugins")]),(0,e._)("p",null,[(0,e.Uk)("leveraged to perform a wider range of tasks like bundle optimization , asset management and injection of enviroment variables. "),(0,e._)("em",null,"extend capabilities")]),(0,e._)("ul",null,[(0,e._)("li",null,"require it"),(0,e._)("li",null,"push to plugins array"),(0,e._)("li",null,[(0,e.Uk)("create instance with "),(0,e._)("code",null,"new")])]),(0,e._)("h3",{id:"mode",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#mode","aria-hidden":"true"},"#"),(0,e.Uk)(" Mode")]),(0,e._)("p",null,[(0,e.Uk)("development,"),(0,e._)("code",null,"production"),(0,e.Uk)(",none built-in optimization that correspond to each environment.")]),(0,e._)("h3",{id:"browser-compatibility",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#browser-compatibility","aria-hidden":"true"},"#"),(0,e.Uk)(" Browser Compatibility")]),(0,e._)("p",null,[(0,e.Uk)('supports all "ES5-compliant" webpack needs Promise for '),(0,e._)("code",null,"import()"),(0,e.Uk)(","),(0,e._)("code",null,"require.ensure()"),(0,e.Uk)(". to support older browser you need to load polyfill.")]),(0,e._)("blockquote",null,[(0,e._)("p",null,"Webpack 5 runs on Node.js version 10.13.0+")]),(0,e._)("h3",{id:"scenarios",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#scenarios","aria-hidden":"true"},"#"),(0,e.Uk)(" Scenarios")]),(0,e._)("ol",null,[(0,e._)("li",null,"Seperate App and Vender Entries")]),(0,e._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,e._)("pre",{class:"language-json"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        main"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" 'xxx'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        vendor"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" 'yyy'\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" '"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("name"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("."),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("contenthash"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(".bundle.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// prod"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" '"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("name"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(".bundle.js' "),(0,e._)("span",{class:"token comment"},"// dev"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])]),(0,e._)("p",null,[(0,e._)("code",null,"optimization.splitChunks"),(0,e.Uk)(" option takes care of seperating vendors and app modules.")]),(0,e._)("h3",{id:"multiple-entry-points",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#multiple-entry-points","aria-hidden":"true"},"#"),(0,e.Uk)(" Multiple Entry Points")]),(0,e._)("p",null,[(0,e.Uk)("Output has a unique name. can use substitutions "),(0,e._)("code",null,"[name]")])],-1),j=(0,e._)("h2",{id:"webpack内容综述",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#webpack内容综述","aria-hidden":"true"},"#"),(0,e.Uk)(" Webpack内容综述")],-1),S=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"章节"),(0,e._)("ul",null,[(0,e._)("li",null,"P1-P3 webpack 的基本概念和日常开发的使用技巧"),(0,e._)("li",null,"P4-P5 以工程化的方式组织webpack构建配置，和webpack打包优化"),(0,e._)("li",null,"P6-P7 详细剖析webpack打包原理和插件，以及loader的实现"),(0,e._)("li",null,"P8 从实际web商城项目出发，讲解webpack实际使用")])],-1),C=(0,e._)("h3",{id:"_01-webpack与构建发展简史",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_01-webpack与构建发展简史","aria-hidden":"true"},"#"),(0,e.Uk)(" 01 webpack与构建发展简史")],-1),P=(0,e._)("p",null,"为什么需要构建工具",-1),E=(0,e._)("ul",null,[(0,e._)("li",null,"转换ES6语法"),(0,e._)("li",null,"转换JSX"),(0,e._)("li",null,"CSS前缀补全/预处理器"),(0,e._)("li",null,"压缩混淆"),(0,e._)("li",null,"图片压缩")],-1),M=(0,e._)("p",null,[(0,e.Uk)("构建演变之路 "),(0,e._)("code",null,"ant+YUI tool --\x3e grunt --\x3e fis3/gulp --\x3e rollup,webpack,parcel")],-1),q=(0,e._)("p",null,"为什么选择webpack",-1),T=(0,e._)("ul",null,[(0,e._)("li",null,"社区生态丰富"),(0,e._)("li",null,"配置灵活和插件化扩展"),(0,e._)("li",null,"官方更新迭代速度快")],-1),N=(0,e._)("p",null,"初识webpack：配置文件名称",-1),L=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("webpack默认配置文件 "),(0,e._)("code",null,"webpack.config.js")]),(0,e._)("li",null,"可以通过 webpack --config 指定配置文件")],-1),O=(0,e._)("p",null,"初识webpack：配置组成",-1),A=(0,e._)("ul",null,[(0,e._)("li",null,"entry // 打包的入口文件"),(0,e._)("li",null,"output // 打包的输出"),(0,e._)("li",null,"mode // 环境"),(0,e._)("li",null,"module.rules // Loader配置"),(0,e._)("li",null,"module.plugins // 插件配置")],-1),I=(0,e._)("p",null,[(0,e._)("strong",null,"零配置"),(0,e.Uk)("webpack包含哪些内容")],-1),W=(0,e._)("ul",null,[(0,e._)("li",null,"默认entry为 ./src/index.js"),(0,e._)("li",null,"默认output为 ./dist/main.js"),(0,e._)("li",null,"loader raw-loader"),(0,e._)("li",null,"plugins HtmlwebpackPlugin template:./src/index.html")],-1),D=(0,e._)("p",null,"环境搭建 Node.js 和 NPM",-1),R=(0,e._)("p",null,"安装webpack和 webpack-cli",-1),H=(0,e._)("p",null,"webpack初体验",-1),z=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    mode"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'production'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/index.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'dist'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'bundle.js'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),J=(0,e._)("p",null,"---\x3e构建结果",-1),B=(0,e._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,e._)("pre",{class:"language-html"},[(0,e._)("code",null,[(0,e._)("span",{class:"token doctype"},[(0,e._)("span",{class:"token punctuation"},"<!"),(0,e._)("span",{class:"token doctype-tag"},"doctype"),(0,e.Uk)(),(0,e._)("span",{class:"token name"},"html"),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("html")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("head")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("title")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("demo"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("title")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("head")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("body")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"src"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("dist/bundle.js"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"}),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("body")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("html")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),$=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("通过npm script 运行"),(0,e._)("code",null,"webpack")]),(0,e._)("p",null,[(0,e._)("strong",null,"原理"),(0,e.Uk)(" 模块局部安装会在 node_modules/.bin目录创建软链接")])],-1),G=(0,e._)("h3",{id:"_02-webpack基础用法",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_02-webpack基础用法","aria-hidden":"true"},"#"),(0,e.Uk)(" 02 webpack基础用法")],-1),F=(0,e._)("p",null,"Entry 用来指定webpack的打包入口",-1),K=(0,e._)("p",null,"模块依赖图的入口是 entry 对于非代码比如图片、字体依赖也会不断加入到依赖图中",-1),V=(0,e._)("p",null,"Entry的用法",-1),Z=(0,e._)("ul",null,[(0,e._)("li",null,"单入口：entry是一个字符串"),(0,e._)("li",null,"多入口：entry是一个对象")],-1),X=(0,e._)("p",null,"Output用来告诉webpack 如何将编译后的文件输出到磁盘",-1),Q=(0,e._)("p",null,"Output的用法：单入口配置",-1),Y=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'./path/to/my/entry/file.js'"),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'bundle.js'"),(0,e.Uk)("\n        path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" __dirname "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'/dist'"),(0,e.Uk)("\n        \n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),nn=(0,e._)("p",null,"Output的用法：多入口配置",-1),sn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        app"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/app.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        search"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/search.js'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name].js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" __dirname "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'/dist'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),an=(0,e._)("blockquote",null,[(0,e._)("p",null,"通过占位符确保文件名称的唯一")],-1),en=(0,e._)("ul",null,[(0,e._)("li",null,"核心概念之Loaders")],-1),ln=(0,e._)("p",null,"webpack开箱即用只支持js和json两种文件类型，通过Loaders去支持其他文件类型并且把它们转化成有效的模块， 并且可以添加到依赖图中。 本身是一个函数，接受源文件作为参数，返回转换的结果。",-1),tn=(0,e._)("p",null,"常见的Loaders",-1),on=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"名称"),(0,e._)("th",null,"描述")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"babel-loader"),(0,e._)("td",null,"转换ES6+等JS新特性语法")]),(0,e._)("tr",null,[(0,e._)("td",null,"css-loader"),(0,e._)("td",null,"支持.css文件的加载和解析")]),(0,e._)("tr",null,[(0,e._)("td",null,"less-loader,sass-loader"),(0,e._)("td",null,"...")]),(0,e._)("tr",null,[(0,e._)("td",null,"ts-loader"),(0,e._)("td",null,"将ts转换成css")]),(0,e._)("tr",null,[(0,e._)("td",null,"file-loader"),(0,e._)("td",null,"进行图片、字体等的打包")]),(0,e._)("tr",null,[(0,e._)("td",null,"raw-loader"),(0,e._)("td",null,"将文件以字符串的形式导入")]),(0,e._)("tr",null,[(0,e._)("td",null,"thread-loader"),(0,e._)("td",null,"多进程打包JS和CSS")])])],-1),pn=(0,e._)("p",null,"Loaders 的用法",-1),cn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'bundle.js'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    module"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        rules"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.txt$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'raw-loader'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br")])],-1),un=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e._)("code",null,"test"),(0,e.Uk)(" 指定匹配规则,"),(0,e._)("code",null,"use"),(0,e.Uk)(" 指定使用的loader名称")])],-1),_n=(0,e._)("ul",null,[(0,e._)("li",null,"核心概念之Plugins")],-1),rn=(0,e._)("p",null,"插件用于bundle文件的优化，资源管理器和环境变量的注入 作用于整个构建过程",-1),kn=(0,e._)("p",null,"常见的Plugins有哪些?",-1),bn=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"名称"),(0,e._)("th",null,"描述")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"CommonsChunkPlugin"),(0,e._)("td",null,"将chunks相同的模块代码提取成公共js")]),(0,e._)("tr",null,[(0,e._)("td",null,"CleanWebpackPlugin"),(0,e._)("td",null,"清理构建目录")]),(0,e._)("tr",null,[(0,e._)("td",null,"ExtractTextWebpackPlugin"),(0,e._)("td",null,"将CSS从bundle文件里提取成一个独立的CSS文件")]),(0,e._)("tr",null,[(0,e._)("td",null,"CopyWebpackPlugin"),(0,e._)("td",null,"将文件或者文件夹拷贝到构建的输出目录")]),(0,e._)("tr",null,[(0,e._)("td",null,"HtmlWebpackPlugin"),(0,e._)("td",null,"创建HTML文件去承载输出的bundle")]),(0,e._)("tr",null,[(0,e._)("td",null,"UglifyjsWebpackPlugin"),(0,e._)("td",null,"压缩JS")]),(0,e._)("tr",null,[(0,e._)("td",null,"ZipWebpackPlugin"),(0,e._)("td",null,"将打包出的资源生成一个zip包")])])],-1),mn=(0,e._)("p",null,"Plugins的用法",-1),dn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'bundle.js'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("template"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'./src/index.html'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),Un=(0,e._)("blockquote",null,[(0,e._)("p",null,"放到plugins的数组里面")],-1),gn=(0,e._)("ul",null,[(0,e._)("li",null,"核心概念之Mode Mode用来指定当前的构建环境是: production development还是none， 设置mode可以使用webpack内置的函数，默认值是production")],-1),wn=(0,e._)("p",null,"Mode的内置函数功能",-1),hn=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"选项"),(0,e._)("th",null,"描述")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"development"),(0,e._)("td",null,"设process.env.NODE_ENV 的值为 development. 开启NamedChunksPlugin+NameModulesPlugin.")]),(0,e._)("tr",null,[(0,e._)("td",null,"production"),(0,e._)("td",null,'设process.env.NODE_ENV 的值为 production. 开启"一堆Plugin"')]),(0,e._)("tr",null,[(0,e._)("td",null,"none"),(0,e._)("td",null,"不开启任何优化选项")])])],-1),vn=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},'"一堆Plugin"'),(0,e._)("ul",null,[(0,e._)("li",null,"FlagDependencyUsagePlugin"),(0,e._)("li",null,"FlagIncludedChunksPlugin"),(0,e._)("li",null,"ModuleConcatentationPlugin"),(0,e._)("li",null,"NoEmitOnErrorsPlugin"),(0,e._)("li",null,"OccurenceOrderPlugin"),(0,e._)("li",null,"SideEffectsFlagPlugin"),(0,e._)("li",null,"TerserPlugin")])],-1),yn=(0,e._)("p",null,"资源解析: 解析ES6 使用babel-loader babel的配置文件是.babelrc",-1),fn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    module"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        rules"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.js$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'babel-loader'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br")])],-1),xn=(0,e._)("p",null,"增加ES6的babel preset配置",-1),jn=(0,e._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,e._)("pre",{class:"language-json"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"presets"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"@babel/preset-env"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"plugins"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"@babel/proposal-class-properties"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),Sn=(0,e._)("blockquote",null,[(0,e._)("p",null,"增加ES6 preset配置")],-1),Cn=(0,e._)("p",null,"资源解析: 解析React JSX",-1),Pn=(0,e._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,e._)("pre",{class:"language-json"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"presets"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"@babel/preset-env"'),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},'"@babel/preset-react"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"plugins"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"@babel/proposal-class-properties"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),En=(0,e._)("blockquote",null,[(0,e._)("p",null,"增加React的 babel-preset 配置")],-1),Mn=(0,e._)("p",null,"资源解析: 解析CSS",-1),qn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    module"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        rules"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"style-loader"'),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},'"css-loader"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),Tn=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("css-loader用于加载.css文件，并且转换成commonjs对象 style-loader 将样式通过"),(0,e._)("code",null,"<style>"),(0,e.Uk)("标签插入到head中")])],-1),Nn=(0,e._)("p",null,[(0,e.Uk)("解析Less和SaSS less-loader 用于将less转换成css 解析图片 file-loader 用于处理文件 "),(0,e._)("code",null,"test: /\\.(png|svg|jpg|gif)$/"),(0,e.Uk)(" 解析字体 file-loader 也可以用于处理字体 "),(0,e._)("code",null,"test: /\\.(woff|woff2|eot|ttf|otf)$/"),(0,e.Uk)(" 使用url-loader url-loader 也可以处理图片和字体 可以设置较小的资源自动base64")],-1),Ln=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    module"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("rules"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.(png|svg|jpg|git)$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        use"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'url-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            options"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("limit"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"10240"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),On=(0,e._)("p",null,"webpack中的文件监听",-1),An=(0,e._)("p",null,"文件监听是在发现源码发生变化时，自动重新构建出新的输出文件。",-1),In=(0,e._)("p",null,"webpack 开启监听模式，有两种方式:",-1),Wn=(0,e._)("ol",null,[(0,e._)("li",null,"启动 webpack命令时，带上--watch参数"),(0,e._)("li",null,"在配置webpack.config.js中设置 watch: true")],-1),Dn=(0,e._)("p",null,"唯一缺陷：每次需要手动 刷新浏览器",-1),Rn=(0,e._)("details",{class:"custom-container details"},[(0,e._)("summary",null,"文件监听原理"),(0,e._)("p",null,"轮询判断文件的最后编辑时间是否变化 某个文件发生了变化，并不会立即告诉监听者，而是先缓存起来，等aggregateTimeout"),(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    watch"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"//默认false"),(0,e.Uk)("\n    watchOptions"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        ignored"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"node_modules"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 默认空，不监听的文件(夹),支持正则匹配"),(0,e.Uk)("\n        aggregateTimeout"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"300"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 监听到变化后会等300ms再去执行，默认300"),(0,e.Uk)("\n        poll"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token number"},"1000"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 判断文件是否变化是通过轮询问系统指定文件有没变化实现的，默认每秒问1000次"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])])],-1),Hn=(0,e._)("p",null,"热更新 webpack-dev-server",-1),zn=(0,e._)("ul",null,[(0,e._)("li",null,"WDS 不刷新浏览器"),(0,e._)("li",null,"WDS 不输出文件，而是放在内存中"),(0,e._)("li",null,[(0,e.Uk)("使用HotModuleReplacementPlugin插件 "),(0,e._)("code",null,"webpack-dev-server --open")])],-1),Jn=(0,e._)("p",null,"热更新 使用webpack-dev-middleware WDS将 webpack输出的文件传输给服务器 适用于灵活的定制场景",-1),Bn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" express"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'express'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpack"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpackDevMiddleware"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-dev-middleware'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" app"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"express"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" config"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.config.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" compiler"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"webpack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("config"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\napp"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"use"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token function"},"webpackDevMiddleware"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("compiler"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    publicPath"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" config"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("output"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("publicPath\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\napp"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"listen"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3000"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'app listening on port 3000'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),$n=(0,e._)("p",null,"热更新的原理分析",-1),Gn=(0,e._)("ul",null,[(0,e._)("li",null,"Webpack Compile: 将JS编译成 Bundle"),(0,e._)("li",null,"HMR Server: 将热更的文件输出给 HMR Runtime"),(0,e._)("li",null,"Bundle server: 提供文件在浏览器的访问"),(0,e._)("li",null,"HMR Runtime: 会被注入到浏览器，更新文件的变化"),(0,e._)("li",null,"bundle.js: 构建输出的文件")],-1),Fn=(0,e._)("p",null,[(0,e._)("img",{src:l,alt:"HMR原理分析"})],-1),Kn=(0,e._)("ul",null,[(0,e._)("li",null,"什么是文件指纹? 打包后输出的文件名的后缀 hash串 文件指纹如何生成"),(0,e._)("li",null,"Hash：和整个项目的构建相关，只要项目文件有修改，整个项目构建的hash值就会更改"),(0,e._)("li",null,"Chunkhash：和webpack打包的chunk有关，不同的entry会生成不同的chunkhash值"),(0,e._)("li",null,"Contenthash: 根据文件内容来定义hash，文件内容不变，则contenthash不变")],-1),Vn=(0,e._)("p",null,[(0,e.Uk)("JS的文件指纹设置 设置output的filename，使用[chunkhash] "),(0,e._)("code",null,"output:{ filename: '[name][chunkhash:8].js' }"),(0,e.Uk)(" CSS文件的指纹设置 设置MiniCssExtractPlugin的filename,使用[contenthash]")],-1),Zn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MiniCssExtractPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},"[name][contenthash:8].css"),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),Xn=(0,e._)("p",null,[(0,e.Uk)("图片文件的指纹设置 设置file-loader的name，使用[hash] "),(0,e._)("code",null,"use: [{loader:'file-loader',options:{name:'img/[name][hash:8].[ext]'}}]")],-1),Qn=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"占位符名称"),(0,e._)("th",null,"含义")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"ext"),(0,e._)("td",null,"资源的后缀名")]),(0,e._)("tr",null,[(0,e._)("td",null,"name"),(0,e._)("td",null,"文件名称")]),(0,e._)("tr",null,[(0,e._)("td",null,"path"),(0,e._)("td",null,"文件的相对路径")]),(0,e._)("tr",null,[(0,e._)("td",null,"folder"),(0,e._)("td",null,"文件所在的文件夹")]),(0,e._)("tr",null,[(0,e._)("td",null,"contenthash"),(0,e._)("td",null,"文件的内容hash，默认md5生成")]),(0,e._)("tr",null,[(0,e._)("td",null,"hash"),(0,e._)("td",null,"文件内容的Hash,默认md5生成")]),(0,e._)("tr",null,[(0,e._)("td",null,"emoji"),(0,e._)("td",null,"一个随机的指代文件内容的emoji")])])],-1),Yn=(0,e._)("p",null,"代码压缩 HTML压缩 CSS压缩 JS压缩",-1),ns=(0,e._)("p",null,"JS文件的压缩 内置了uglifyjs-webpack-plugin CSS文件的压缩 使用optimize-css-assets-webpack-plugin，同时使用 cssnano",-1),ss=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"OptimizeCSSAssetsPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        assetsNameRegExp"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"g")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        cssProcessor"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'cssnano'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br")])],-1),as=(0,e._)("p",null,"html文件的压缩 修改html-webpack-plugin, 设置压缩参数",-1),es=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HtmlWebpackPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"join"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'src/search.html'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'search.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    chunks"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'search'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    inject"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    minify"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        html5"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        collapseWhitespace"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        preserveLineBreaks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        minifyCSS"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        minifyJS"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        removeComments"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e.Uk)(" 的定义"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" font"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("size "),(0,e._)("span",{class:"token keyword"},"of"),(0,e.Uk)(" the root elementrem 和 px 对比\n移动端"),(0,e._)("span",{class:"token constant"},"CSS"),(0,e.Uk)(" px自动转换成rem\n使用px2rem"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br")])],-1),ls=(0,e._)("h3",{id:"_03-webpack进阶用法",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_03-webpack进阶用法","aria-hidden":"true"},"#"),(0,e.Uk)(" 03 webpack进阶用法")],-1),ts=(0,e._)("ol",null,[(0,e._)("li",null,"当前构建的问题 每次构建的时候不会清理目录，造成构建的输出目录output文件越来越多")],-1),os=(0,e._)("p",null,[(0,e.Uk)("通过 npm scripts 清理构建目录 "),(0,e._)("code",null,"rm -rf ./dist && webpack"),(0,e._)("code",null,"rimraf ./dist && webpack")],-1),ps=(0,e._)("p",null,"自动清理构建目录 避免构建前每次都需要手动删除dist 使用clean-webpack-plugin ,默认会删除output指定的输出目录",-1),cs=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"CleanWebpackPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(" \n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),us=(0,e._)("ol",{start:"2"},[(0,e._)("li",null,"CSS3属性为什么需要前缀?")],-1),_s=(0,e._)("ul",null,[(0,e._)("li",null,"Trident(-ms)"),(0,e._)("li",null,"Geko(-moz)"),(0,e._)("li",null,"Webkit(-webkit)"),(0,e._)("li",null,"Presto(-o)")],-1),is=(0,e._)("p",null,"举个例子",-1),rs=(0,e._)("div",{class:"language-css ext-css line-numbers-mode"},[(0,e._)("pre",{class:"language-css"},[(0,e._)("code",null,[(0,e._)("span",{class:"token selector"},".box"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"-moz-border-radius"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 10px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"-webkit-border-radius"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 10px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"-o-border-radius"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 10px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"border-radius"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 10px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br")])],-1),ks=(0,e._)("p",null,"PostCSS插件 autoprefixer 自动补齐CSS3前缀 使用 autoprefixer 插件 根据 CanIUse规则",-1),bs=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("rules"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.less$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    use"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'style-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'css-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'less-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'postcss-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'autoprefixer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                        browsers"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"last 2 version"'),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},'">1%"'),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},'"iOS 7"'),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br")])],-1),ms=(0,e._)("ol",{start:"3"},[(0,e._)("li",null,"浏览器的分辨率 CSS 媒体查询实现响应式布局")],-1),ds=(0,e._)("div",{class:"language-css ext-css line-numbers-mode"},[(0,e._)("pre",{class:"language-css"},[(0,e._)("code",null,[(0,e._)("span",{class:"token atrule"},[(0,e._)("span",{class:"token rule"},"@media"),(0,e.Uk)(" screen "),(0,e._)("span",{class:"token keyword"},"and"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token property"},"max-width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 980px"),(0,e._)("span",{class:"token punctuation"},")")]),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token selector"},".header"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token property"},"width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 900px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token atrule"},[(0,e._)("span",{class:"token rule"},"@media"),(0,e.Uk)(" screen "),(0,e._)("span",{class:"token keyword"},"and"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token property"},"max-width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 480px"),(0,e._)("span",{class:"token punctuation"},")")]),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token selector"},".header"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token property"},"width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 400px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token atrule"},[(0,e._)("span",{class:"token rule"},"@media"),(0,e.Uk)(" screen "),(0,e._)("span",{class:"token keyword"},"and"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token property"},"max-width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 350px"),(0,e._)("span",{class:"token punctuation"},")")]),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token selector"},".header"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token property"},"width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 300px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),Us=(0,e._)("ol",{start:"4"},[(0,e._)("li",null,"rem 是什么")],-1),gs=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("W3C 对 "),(0,e._)("code",null,"rem"),(0,e.Uk)(" 的定义: font-size of the root element")])],-1),ws=(0,e._)("p",null,"rem 和 px 对比",-1),hs=(0,e._)("ul",null,[(0,e._)("li",null,"rem 是相对单位"),(0,e._)("li",null,"px 是绝对单位")],-1),vs=(0,e._)("p",null,"移动端CSS px自动转换成rem",-1),ys=(0,e._)("p",null,[(0,e.Uk)("使用"),(0,e._)("code",null,"px2rem-loader"),(0,e.Uk)(" 页面渲染时计算根元素的font-size值")],-1),fs=(0,e._)("ul",null,[(0,e._)("li",null,"可以使用手淘的lib-flexible库"),(0,e._)("li",null,"https://github.com/amfe/lib-flexible")],-1),xs=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" rules1"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},"'style-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'css-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'less-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'px2rem-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            remUnit"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"75"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            remPecision"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"8"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),js=(0,e._)("p",null,"资源内联的意义 代码层面：",-1),Ss=(0,e._)("ul",null,[(0,e._)("li",null,"页面框架的初始化脚本"),(0,e._)("li",null,"上报相关打点"),(0,e._)("li",null,"css内联避免页面闪动 请求层面: 减少HTTP网络请求数"),(0,e._)("li",null,"小图片或者字体内联 url-loader")],-1),Cs=(0,e._)("p",null,"HTML 和 JS 内联",-1),Ps=(0,e._)("p",null,"raw-loader 内联 html",-1),Es=(0,e._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,e._)("pre",{class:"language-html"},[(0,e._)("code",null,[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"},[(0,e._)("span",{class:"token language-javascript"},[(0,e.Uk)("$"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'raw-loader!babel-loader!./meta.html'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"}")])]),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),Ms=(0,e._)("p",null,"raw-loader 内联 js",-1),qs=(0,e._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,e._)("pre",{class:"language-html"},[(0,e._)("code",null,[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"},[(0,e._)("span",{class:"token language-javascript"},[(0,e.Uk)("$"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'raw-loader!babel-loader!../node_modules/lib-flexible'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"}")])]),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),Ts=(0,e._)("p",null,"css 内联 方案一 借助 style-loader 方案二 html-inline-css-webpack-plugin",-1),Ns=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" rules1"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" \n        loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'style-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            insertAt"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'top'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token comment"},"// 样式插入到<head>"),(0,e.Uk)("\n            singleton"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token comment"},"// 将所有的style标签合并成一个"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'css-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'sass-loader'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),Ls=(0,e._)("p",null,"多页面应用(PWA)概念",-1),Os=(0,e._)("blockquote",null,[(0,e._)("p",null,"每一次页面跳转的时候，后台服务器都会给返回一个新的html文档，"),(0,e._)("p",null,"这种类型的网站也就是多页面网站，也叫做多页面应用")],-1),As=(0,e._)("p",null,"多页面打包基本思路",-1),Is=(0,e._)("p",null,"每个页面对应一个entry，一个html-webpack-plugin 缺点：每次新增或删除页面需要改webpack配置",-1),Ws=(0,e._)("p",null,"多页面打包 通用方案",-1),Ds=(0,e._)("p",null,"动态获取entry 和设置 html-webpack-plugin 利用 glob.sync",-1),Rs=(0,e._)("ul",null,[(0,e._)("li",null,"entry: glob.sync(path.join(__dirname,'./src/*/index.js')),")],-1),Hs=(0,e._)("p",null,"使用 source map",-1),zs=(0,e._)("p",null,"作用：通过source map定位到源码",-1),Js=(0,e._)("ul",null,[(0,e._)("li",null,"source map 科普 阮一峰javascript_source_map")],-1),Bs=(0,e._)("p",null,"开发环境开启，线上环境关闭",-1),$s=(0,e._)("ul",null,[(0,e._)("li",null,"线上排查问题的时候可以将sourcemap上传到错误监控系统")],-1),Gs=(0,e._)("p",null,"source map 关键字",-1),Fs=(0,e._)("p",null,"eval: 使用eval包裹模块代码",-1),Ks=(0,e._)("p",null,"source map： 产生.map文件",-1),Vs=(0,e._)("p",null,"cheap： 不包含列信息",-1),Zs=(0,e._)("p",null,"inline： 将.map作为DataURI嵌入，不单独产生.map文件",-1),Xs=(0,e._)("p",null,"module：包含loader的sourcemap",-1),Qs=(0,e._)("p",null,"source map 类型",-1),Ys=(0,e._)("ul",null,[(0,e._)("li",null,"none =prod yes"),(0,e._)("li",null,"eval"),(0,e._)("li",null,"cheap-eval-source-map"),(0,e._)("li",null,"cheap-module-source-map"),(0,e._)("li",null,"eval-source-map"),(0,e._)("li",null,"cheap-source-map =prod yes"),(0,e._)("li",null,"cheap-module-source-map =prod yes"),(0,e._)("li",null,"inline-cheap-source-map"),(0,e._)("li",null,"inline-cheap-module-source-map"),(0,e._)("li",null,"source-map =prod yes"),(0,e._)("li",null,"inline-source-map"),(0,e._)("li",null,"hidden-source-map =prod yes")],-1),na=(0,e._)("p",null,"基础库分离 思路：将react、react-dom 基础包通过cdn引入，不打入bundle中 方法：使用html-webpack-externals-plugin",-1),sa=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("cosnt plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HtmlWebpackExternalsPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        externals"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'react'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("entry"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'//cdn/react.min.js?v=123'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'react-dom'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("entry"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'//cdn/react-dom.min.js?v=123'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),aa=(0,e._)("p",null,"使用SplitChunksPlugin 进行公共脚本分离 webpack4 内置的，替代CommonsChunkPlugin 插件",-1),ea=(0,e._)("p",null,"chunks 参数说明：",-1),la=(0,e._)("ul",null,[(0,e._)("li",null,"async 异步引入的库进行分离(默认)"),(0,e._)("li",null,"initial 同步引入的库进行分离"),(0,e._)("li",null,"all 所有引入的库进行分离(推荐)")],-1),ta=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\noptimization"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    splitChunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        chunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'async'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        minSize"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"30000"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        maxSize"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        minChunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        maxAsyncRequests"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"5"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        maxInitialRequests"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        automaticNameDelimiter"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'~'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        cacheGroups"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            vendors"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"[\\\\/]node_modules[\\\\/]"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            priority"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"-"),(0,e._)("span",{class:"token number"},"10"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br")])],-1),oa=(0,e._)("p",null,"利用SplitChunksPlugin 分离基础包",-1),pa=(0,e._)("p",null,"test: 匹配出需要分离的包",-1),ca=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("optimization"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("splitChunks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("cacheGroups"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    commons"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"(react|react-dom)"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'vendors'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        chunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'all'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),ua=(0,e._)("p",null,"利用SplitChunksPlugin 分离公共文件",-1),_a=(0,e._)("p",null,"minChunks: 设置最小引用次数为2次 minSize：分离的包体积的大小",-1),ia=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("optimiaztion"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("splitChunks"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    minSize"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    cacheGroups"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        commons"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'commons'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            chunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'all'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            minChunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"2"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),ra=(0,e._)("p",null,"Tree Shaking(摇树优化) 概念： 1个模块可能有多个方法，只要其中的某个方法使用到了，则整个文件都会被打到bundle里面去，tree-shaking就是只把用到的方法打入bundle，没用到的方法会在uglify阶段被擦除掉。",-1),ka=(0,e._)("p",null,"使用：webpack默认支持，在.babelrc中里设置modules:false即可",-1),ba=(0,e._)("ul",null,[(0,e._)("li",null,"production mode的情况下默认开启")],-1),ma=(0,e._)("p",null,"要求: 必须是ES6的语法,CJS的方式不支持",-1),da=(0,e._)("p",null,"DCE(Dead code elimination) 代码不会被执行,不可到达 代码执行的结果不会被用到 代码只会影响死变量(只写不读)",-1),Ua=(0,e._)("p",null,"Tree-Shanking原理 利用ES6 模块的特点:",-1),ga=(0,e._)("ul",null,[(0,e._)("li",null,"只能作为模块顶层的语句出现(静态编译)"),(0,e._)("li",null,"import的模块名只能是字符串常量"),(0,e._)("li",null,"import binding 是 immutable的 代码擦除:uglify阶段删除无用代码")],-1),wa=(0,e._)("p",null,"现象:构建后的代码存在大量闭包代码",-1),ha=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("    "),(0,e._)("span",{class:"token comment"},"//a.js"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'xxxx'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"//b.js"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" index "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./a'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("index"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br")])],-1),va=(0,e._)("p",null,"---\x3e",-1),ya=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("__webpack_exports__"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("webpack_require__")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},'"use strict"'),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    __webpack_require__"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"r"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__webpack_exports__"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _js_index_WEBPACK_IMPORTED_MODULE_0__"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"__webpack_require__"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n        console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__js_index_WEBPACK_IMPORTED_MODULE_0__"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"default"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),fa=(0,e._)("p",null,"会导致什么问题? 大量作用域包裹代码,导致体积增大(模块越多越明显) 运行代码时创建的函数作用域变多,内存开销变大",-1),xa=(0,e._)("p",null,"模块转换分析",-1),ja=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" helloworld "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./helloworld'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'../../common'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\ndocument"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"write"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token function"},"helloworld"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),Sa=(0,e._)("p",null,"---\x3e",-1),Ca=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"/* harmony import */"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _common__WEBPACK_IMPORTED_MODULE_0__"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"__webpack_requrie__"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"/* harmony import */"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _common__WEBPACK_IMPORTED_MODULE_1__"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"__webpack_requrie__"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),Pa=(0,e._)("p",null,"结论:",-1),Ea=(0,e._)("ul",null,[(0,e._)("li",null,"被webpack转换后的模块会带上一层包裹"),(0,e._)("li",null,"import 会被转换成 __webpack_require")],-1),Ma=(0,e._)("p",null,"进一步分析webpack的模块机制 分析:",-1),qa=(0,e._)("ul",null,[(0,e._)("li",null,"打包出来的是一个IIFE(匿名闭包)"),(0,e._)("li",null,"modules是一个数组,每一项是一个模块初始化函数"),(0,e._)("li",null,"__webpack_require 用来加载模块,返回 modules.exports"),(0,e._)("li",null,[(0,e.Uk)("通过"),(0,e._)("code",null,"WEBPACK_REQUIRE_METHOD(0)"),(0,e.Uk)(" 启动程序")])],-1),Ta=(0,e._)("p",null,"scope hoisting原理 原理: 将所有模块的代码按照引用顺序放在一个函数作用域里,然后适当的重命名一些变量以防止变量名冲突 对比: 通过scope hoisting可以减少函数声明代码和内存开销 scope hoisting使用 webpack mode为production 默认开启 必须是ES6语法 CJS不支持",-1),Na=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("    "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},[(0,e.Uk)("webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("optimize"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("ModuleConcatenationPlugin")]),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),La=(0,e._)("p",null,"代码分割的意义",-1),Oa=(0,e._)("p",null,"对于大的web应用来讲,将所有的代码都放在一个文件中显然是不够有效的, 特别是当你的某些代码是在某些特殊的时候才会被使用到.webapck有一个功能就是将你的 代码库分割成chunks(语块),当代码运行到需要它们的时候在进行加载.",-1),Aa=(0,e._)("p",null,"适用的场景: 抽离相同代码到一个共享块 脚本懒加载,使得初始下载的代码更小",-1),Ia=(0,e._)("p",null,"懒加载JS脚本的方式 CommonjS: require.ensure ES6: 动态import(目前还没原生支持,需要babel转换)",-1),Wa=(0,e._)("p",null,"如果使用动态 import? 安装babel插件 @babel/plugin-syntax-dynamic-import",-1),Da=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'@babel/plugin-syntax-dynamic-import'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),Ra=(0,e._)("p",null,"代码分割效果 Assert Size Chunks xxxx.js 176 bytes 2 [emmitted]",-1),Ha=(0,e._)("p",null,"ESLint的必要性 案例: 某手机系统的webview而没有使用X5内核,解析JSON时遇到重复key报错,导致白屏",-1),za=(0,e._)("blockquote",null,[(0,e._)("p",null,"如何避免类似代码问题?")],-1),Ja=(0,e._)("p",null,"行业里优秀的 ESLint 规范实践 腾讯:",-1),Ba=(0,e._)("ul",null,[(0,e._)("li",null,"alloyteam 团队-> eslint-config-alloy"),(0,e._)("li",null,"ivweb 团队-> eslint-config-ivweb")],-1),$a=(0,e._)("p",null,"制定团队的ESLint 规范 不重复早轮子,基于 eslint:recommend 配置并改进 能够帮助发现代码错误的规则,全部开启 帮助保持团队的代码风格统一,而不是限制开发体验",-1),Ga=(0,e._)("p",null,[(0,e.Uk)("ESLint如何落地 和CI/CD系统集成,和webpack集成 方案一: webpack与CI/CD集成 "),(0,e._)("strong",null,"CI PIPELINE"),(0,e.Uk)(" 增加 lint pipeline 本地开发阶段增加pre commit钩子")],-1),Fa=(0,e._)("ol",null,[(0,e._)("li",null,"安装husky"),(0,e._)("li",null,"增加npm script -> precommit lint-staged")],-1),Ka=(0,e._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,e._)("pre",{class:"language-json"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"lint-staged"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" linters"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token property"},'"*.{js,scss}"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},'"eslint --fix"'),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},'"git add"'),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),Va=(0,e._)("p",null,"方案二: webpack与ESLint集成 使用eslint-loader,构建时检查JS规范",-1),Za=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("rules"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("use"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'babel-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'eslint-loader'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),Xa=(0,e._)("p",null,"webpack打包库和组件 webpack除了可以用来打包应用,也可以用来打包js库 实现一个大整数加法的打包",-1),Qa=(0,e._)("ul",null,[(0,e._)("li",null,"需要打包压缩版和非压缩版本"),(0,e._)("li",null,"支持AMD/CJS/CJS/ESM 模块引入 库的目录结构和打包要求 打包输出的库名称:"),(0,e._)("li",null,"未压缩版 large-number.js"),(0,e._)("li",null,"压缩版 large-number.min.js")],-1),Ya=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"|-/dist\n|--large-number.js\n|--large-number.min.js\n|-webpack.config.js\n|-package.json\n|-/src\n|--index.js\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),ne=(0,e._)("p",null,[(0,e.Uk)("支持的使用方式 ESM: "),(0,e._)("code",null,"import * as largeNumber from 'large-number'; largeNumber(a,b);")],-1),se=(0,e._)("p",null,[(0,e.Uk)("CJS: "),(0,e._)("code",null,"const largeNumber = require('large-number'); largeNumber(a,b);")],-1),ae=(0,e._)("p",null,[(0,e.Uk)("AMD: "),(0,e._)("code",null,"require(['large-number'],function(largeNumber){ largeNumber(a,b);});")],-1),ee=(0,e._)("p",null,"可以直接通过script引入",-1),le=(0,e._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,e._)("pre",{class:"language-html"},[(0,e._)("code",null,[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"src"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("https://unpkg.com/large-number"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"}),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"},[(0,e._)("span",{class:"token language-javascript"},[(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// global variable"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"largeNumber"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'999'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'1'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// Property in the window object"),(0,e.Uk)("\n    window"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"largeNumber"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'999'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'1'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),te=(0,e._)("p",null,"如何将库暴露出去? library: 指定库的全局变量 libraryTarget: 支持库的引入方式",-1),oe=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    mode"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'production'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'large-number'"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/index.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'large-number.min'"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/index.js'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name].js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        library"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'largeNumber'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        libraryExport"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'default'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        libraryTarget"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'umd'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br")])],-1),pe=(0,e._)("p",null,"如何只对 .min压缩 通过inclue设置 只压缩min.js 结尾的文件",-1),ce=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("optimization"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    minimize"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    minmizer"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"TerserPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            inclue"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.min\\.js$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),ue=(0,e._)("p",null,"设置入口文件 package.json的main字段为 index.js",-1),_e=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("env"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token constant"},"NODE_ENV"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"==="),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'production'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(" module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/large-number.min.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n "),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(" module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/large-number.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),ie=(0,e._)("p",null,"页面打开过程 服务端渲染(SSR)是什么 渲染:HTML+CSS+JS+Data -> 渲染后的HTML",-1),re=(0,e._)("p",null,"服务端: 所有模板等资源都存在服务端 内网机器拉取数据更快 一个HTML返回所有数据",-1),ke=(0,e._)("p",null,"浏览器和服务器交互流程 请求开始-server-{html-template,data}-serverRender -浏览器解析并渲染-加载并执行js和其他资源-页面完全可交互",-1),be=(0,e._)("p",null,"客户端渲染vs服务端渲染",-1),me=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th"),(0,e._)("th",null,"客户端渲染"),(0,e._)("th",null,"服务端渲染")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"请求"),(0,e._)("td",null,"多个请求(HTML,数据等)"),(0,e._)("td",null,"1个请求")]),(0,e._)("tr",null,[(0,e._)("td",null,"加载过程"),(0,e._)("td",null,"HTML&数据串行加载"),(0,e._)("td",null,"1个请求返回HTML和数据")]),(0,e._)("tr",null,[(0,e._)("td",null,"渲染"),(0,e._)("td",null,"前端渲染"),(0,e._)("td",null,"服务端渲染")]),(0,e._)("tr",null,[(0,e._)("td",null,"可交互"),(0,e._)("td",null,"图片等静态资源加载完成,JS逻辑执行完可交互"),(0,e._)("td")])])],-1),de=(0,e._)("p",null,"总结: 服务端渲染(SSR)的核心是减少请求",-1),Ue=(0,e._)("p",null,"SSR的优势",-1),ge=(0,e._)("ol",null,[(0,e._)("li",null,"减少白屏时间"),(0,e._)("li",null,"对于SEO友好")],-1),we=(0,e._)("p",null,"SSR代码实现思路 服务端",-1),he=(0,e._)("ul",null,[(0,e._)("li",null,"使用 react-dom/server的 renderToString 方法将React组件渲染成字符串"),(0,e._)("li",null,"服务端路由返回对应的模板 客户端"),(0,e._)("li",null,"打包出针对服务端的组件")],-1),ve=(0,e._)("p",null,"Webapck ssr打包存在的问题 浏览器全局变量(Node.js中 没有 document,window);",-1),ye=(0,e._)("ul",null,[(0,e._)("li",null,"组件适配: 将不兼容的组件根据打包环境进行适配"),(0,e._)("li",null,[(0,e.Uk)("请求适配: 将fetch或者ajax发送请求的写法改成"),(0,e._)("code",null,"isomorphic-fetch"),(0,e.Uk)("或者"),(0,e._)("code",null,"axios"),(0,e.Uk)(" 样式问题(Node.js无法解析样式css)")]),(0,e._)("li",null,"方案一: 服务端打包通过ignore-loader忽略掉css的解析"),(0,e._)("li",null,"方案二: 将style-loader替换成isomorphic-style-loader")],-1),fe=(0,e._)("p",null,"如何解决样式不显示的问题?",-1),xe=(0,e._)("p",null,"使用打包出来的浏览器端HTML为模板",-1),je=(0,e._)("p",null,[(0,e.Uk)("设置占位符,动态插入组件 "),(0,e._)("code",null,"\x3c!--HTML_PLACEHOLDER--\x3e")],-1),Se=(0,e._)("p",null,"首屏数据如何处理 服务端获取数据 替换占位符",-1),Ce=(0,e._)("p",null,"当前构建时的日志显示 展示一大堆日志,很多并不是开发者关注 统计信息 stats",-1),Pe=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"preset"),(0,e._)("th",null,"alternative"),(0,e._)("th",null,"description")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"errors-only"),(0,e._)("td",null,"none"),(0,e._)("td",null,"只在发生错误时输出")]),(0,e._)("tr",null,[(0,e._)("td",null,"minimal"),(0,e._)("td",null,"none"),(0,e._)("td",null,"只在发生错误或有新的编译时输出")]),(0,e._)("tr",null,[(0,e._)("td",null,"none"),(0,e._)("td",null,"false"),(0,e._)("td",null,"没有输出")]),(0,e._)("tr",null,[(0,e._)("td",null,"normal"),(0,e._)("td",null,"true"),(0,e._)("td",null,"标准输出")]),(0,e._)("tr",null,[(0,e._)("td",null,"verbose"),(0,e._)("td",null,"none"),(0,e._)("td",null,"全部输出")])])],-1),Ee=(0,e._)("p",null,"如何优化命令行的构建日志 使用 friendly-errors-webpack-plugin",-1),Me=(0,e._)("ul",null,[(0,e._)("li",null,"success 构建成功的日志提示"),(0,e._)("li",null,"warning 构建警告时的日志提示"),(0,e._)("li",null,"error 构建报错时的日志提示")],-1),qe=(0,e._)("p",null,"stats 设置成erros-only",-1),Te=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"FriendlyErrorsWebpackPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" stats"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token string"},'"errors-only"'),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),Ne=(0,e._)("p",null,"如何判断构建是否成功? 在CI/CD 的 pipeline 或者发布系统需要知道当前构建状态",-1),Le=(0,e._)("p",null,[(0,e.Uk)("每次构建完成后输入 "),(0,e._)("code",null,"echo $?"),(0,e.Uk)(" 获取错误码")],-1),Oe=(0,e._)("p",null,"构建异常和中断处理 webpack4之前的版本构建失败不会抛出错误码(error code) Node.js 中的 prcess.exit 规范",-1),Ae=(0,e._)("ul",null,[(0,e._)("li",null,"0 表示成功完成,回调函数中,err 为null"),(0,e._)("li",null,"非0 表示执行失败,回调函数中,error不为null,error.code 就是传给exit的数字")],-1),Ie=(0,e._)("p",null,"如何主动捕获并处理构建错误? compiler在每次构建结束后出发 done这个 hook",-1),We=(0,e._)("p",null,"process.exit 主动处理构建报错",-1),De=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hook"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("done"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'done'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"stats"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("stats"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("compilation"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("erros "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" stats"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("compilation"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("erros"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"indexOf"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'--watch'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"==="),(0,e._)("span",{class:"token operator"},"-"),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'build error'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"exit"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),Re=(0,e._)("h3",{id:"_04-编写可维护的webpack构建配置",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_04-编写可维护的webpack构建配置","aria-hidden":"true"},"#"),(0,e.Uk)(" 04 编写可维护的webpack构建配置")],-1),He=(0,e._)("p",null,"构建配置抽离成npm包的意义",-1),ze=(0,e._)("p",null,"通用性",-1),Je=(0,e._)("ul",null,[(0,e._)("li",null,"业务开发者无需关注构建配置"),(0,e._)("li",null,"统一团队构建脚本")],-1),Be=(0,e._)("p",null,"可维护性",-1),$e=(0,e._)("ul",null,[(0,e._)("li",null,"构建配置合理的拆分"),(0,e._)("li",null,"README文档、ChangeLog文档")],-1),Ge=(0,e._)("p",null,"质量",-1),Fe=(0,e._)("ul",null,[(0,e._)("li",null,"冒烟测试、单元测试、测试覆盖率"),(0,e._)("li",null,"持续集成")],-1),Ke=(0,e._)("p",null,"构建配置管理的 可选方案",-1),Ve=(0,e._)("ul",null,[(0,e._)("li",null,"通过多个配置文件管理不同环境的构建， webpack --config参数进行控制"),(0,e._)("li",null,"将构建配置设计成一个库，比如hjs-webpack，Neutino，webpack-blocks"),(0,e._)("li",null,"抽成一个工具进行管理，比如create-react-app，kyt，nwb"),(0,e._)("li",null,"将所有配置放在一个文件，通过 --env 参数控制分支选择")],-1),Ze=(0,e._)("p",null,"构建配置包设计 通过多个配置文件管理不同环境的webpack配置",-1),Xe=(0,e._)("ul",null,[(0,e._)("li",null,"基础配置 webpack.base.js"),(0,e._)("li",null,"开发环境 dev"),(0,e._)("li",null,"生产环境 prod"),(0,e._)("li",null,"ssr环境 ssr")],-1),Qe=(0,e._)("p",null,"抽离成一个npm包统一管理",-1),Ye=(0,e._)("ul",null,[(0,e._)("li",null,"规范： git commit日志，readme，eslint规范，semver规范"),(0,e._)("li",null,"质量： 冒烟测试，单元测试，测试覆盖旅和CI")],-1),nl=(0,e._)("p",null,"通过webpack-merge 组合配置",-1),sl=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" merge "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-merge'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"merge"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("baseConfig"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("devConfig"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),al=(0,e._)("p",null,"功能模块设计",-1),el=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("基础配置：base "),(0,e._)("ul",null,[(0,e._)("li",null,"资源解析:ES6,React,CSS,Less,图片,字体"),(0,e._)("li",null,"样式增强:CSS前缀补齐，CSS px转换成rem"),(0,e._)("li",null,"目录清理"),(0,e._)("li",null,"多页面打包"),(0,e._)("li",null,"命令行信息显示优化"),(0,e._)("li",null,"错误捕获和处理"),(0,e._)("li",null,"CSS提取成一个单独的文件")])]),(0,e._)("li",null,[(0,e.Uk)("开发阶段配置： "),(0,e._)("ul",null,[(0,e._)("li",null,"代码热更新：CSS热更新，JS热更新"),(0,e._)("li",null,"sourcemap")])]),(0,e._)("li",null,[(0,e.Uk)("生产阶段配置： "),(0,e._)("ul",null,[(0,e._)("li",null,"代码压缩"),(0,e._)("li",null,"文件指纹"),(0,e._)("li",null,"Tree Shaking"),(0,e._)("li",null,"Scope Hoisting"),(0,e._)("li",null,"速度优化： 基础包CDN"),(0,e._)("li",null,"体积优化： 代码分割")])]),(0,e._)("li",null,[(0,e.Uk)("SSR配置： "),(0,e._)("ul",null,[(0,e._)("li",null,"output的libraryTarget设置"),(0,e._)("li",null,"CSS解析的ignore")])])],-1),ll=(0,e._)("p",null,"目录结构设计 lib 放置源代码 test 放置测试代码 使用eslint规范构建脚本 使用 eslint-config-airbnb-base eslint --fix 可以自动处理空格",-1),tl=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},'"parser"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"babel-eslint"'),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},'"extends"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"eslint-config-airbnb-base"'),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},'"env"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},'"browser"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"node"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),ol=(0,e._)("p",null,"冒烟测试 smoke testing 冒烟测试是指对提交测试的软件在进行详细深入的测试之前而进行的预测试， 这种预测试的主要目的是暴露导致软件需重新发布的基本功能失效等严重问题",-1),pl=(0,e._)("p",null,"冒烟测试执行 构建是否成功 每次构建完成build目录是否有内容输出",-1),cl=(0,e._)("ul",null,[(0,e._)("li",null,"是否有JS、CSS等静态资源文件"),(0,e._)("li",null,"是否有HTML文件")],-1),ul=(0,e._)("p",null,"判断是否构建成功 在示例项目里面运行构建，看看是否有报错",-1),_l=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpack "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" rimraf "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'rimraf'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" Mocha "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'mocha'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" mocha "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Mocha"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" timeout"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'10000ms'"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nprocess"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"chdir"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"rimraf"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" prodConfig"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../../lib/webpack.prod'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"webpack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("prodConfig"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("stats")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(" console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"error"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"return"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("stats"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"toString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            colors"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("modules"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("children"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("chunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("chunkMoudles"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token boolean"},"false"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'\\n'"),(0,e._)("span",{class:"token operator"},"+"),(0,e._)("span",{class:"token string"},"'Complier success, begin mocha test'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br")])],-1),il=(0,e._)("p",null,"判断基本功能是否正常 编写mocha测试用例 是否有JS，CSS静态资源，HTML文件;",-1),rl=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" glob "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("  "),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'glob-all'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"describe"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'checking generated file exists'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"it"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'should generate html files'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"done"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" files"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("glob"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"sync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'./dist/index.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'./dist/search.html'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("files"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length"),(0,e._)("span",{class:"token operator"},">"),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"done"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"throw"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Error"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'No html files found'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token function"},"it"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'should generate js & css files'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" files"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("glob"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"sync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'./dist/index_*.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'./dist/index_*.css'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("files"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length"),(0,e._)("span",{class:"token operator"},">"),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"done"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"throw"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Error"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'No files found'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),kl=(0,e._)("p",null,"单元测试与测试覆盖率 单纯测试框架，需要断言库",-1),bl=(0,e._)("ul",null,[(0,e._)("li",null,"chai"),(0,e._)("li",null,"should.js"),(0,e._)("li",null,"expect"),(0,e._)("li",null,"better-assert")],-1),ml=(0,e._)("p",null,"集成框架 开箱即用",-1),dl=(0,e._)("ul",null,[(0,e._)("li",null,"Jasmine"),(0,e._)("li",null,"Jest")],-1),Ul=(0,e._)("p",null,"极简API",-1),gl=(0,e._)("p",null,"编写单元测试用例",-1),wl=(0,e._)("ul",null,[(0,e._)("li",null,"技术选型: Mocha + Chai"),(0,e._)("li",null,"测试代码: describe + it + expect"),(0,e._)("li",null,"测试命令: mocha add.test.js")],-1),hl=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" expect "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'chai'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("expect"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" add "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../src/add'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"describe"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'use expect: src/add.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"it"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'add(1,2)===3'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"expect"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("to"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"equal"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),vl=(0,e._)("p",null,"单元测试接入",-1),yl=(0,e._)("ol",null,[(0,e._)("li",null,"安装 mocha + chai"),(0,e._)("li",null,"新建test目录，并增加 [name].test.js测试文件"),(0,e._)("li",null,[(0,e.Uk)("在package.json中 scripts 字段增加 test命令 "),(0,e._)("code",null,"node_modules/mocha/bin/_mocha")]),(0,e._)("li",null,[(0,e.Uk)("执行测试命令 "),(0,e._)("code",null,"npm run test")])],-1),fl=(0,e._)("p",null,"持续集成的作用 优点： 快速发现错误，放置分支大幅偏离主干",-1),xl=(0,e._)("p",null,"核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失效就不能集成。",-1),jl=(0,e._)("p",null,"Github最流行的CI （top10 Travis CI,Circle CI,Jenkins,AppVeyor,CodeShip,Drone,Semaphore CI,Buildkite,Wercker,TeamCity",-1),Sl=(0,e._)("p",null,"接入Travis CI",-1),Cl=(0,e._)("ol",null,[(0,e._)("li",null,"https://travis-ci.org 使用github账号登录"),(0,e._)("li",null,"在/account/repositories 为项目开启"),(0,e._)("li",null,"项目根目录下新增 travis.yml")],-1),Pl=(0,e._)("p",null,"yml文件内容 install安装项目依赖 ，script运行测试用例",-1),El=(0,e._)("div",{class:"language-yaml ext-yml line-numbers-mode"},[(0,e._)("pre",{class:"language-yaml"},[(0,e._)("code",null,[(0,e._)("span",{class:"token key atrule"},"language"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" node_js\n\n"),(0,e._)("span",{class:"token key atrule"},"sudo"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean important"},"false"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token key atrule"},"cache"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token key atrule"},"apt"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean important"},"true"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token key atrule"},"directories"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" node_modules\n\n"),(0,e._)("span",{class:"token key atrule"},"node_js"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" stable "),(0,e._)("span",{class:"token comment"},"# 设置相应版本"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token key atrule"},"install"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" npm install "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("D "),(0,e._)("span",{class:"token comment"},"# 安装构建依赖器"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" cd ./test/template"),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("project\n    "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" npm install "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)("D "),(0,e._)("span",{class:"token comment"},"# 安装构建依赖器"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token key atrule"},"script"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" \n    "),(0,e._)("span",{class:"token punctuation"},"-"),(0,e.Uk)(" npm test\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br")])],-1),Ml=(0,e._)("p",null,[(0,e.Uk)("发布到npm 添加用户 "),(0,e._)("code",null,"npm adduser"),(0,e.Uk)(" 升级版本")],-1),ql=(0,e._)("ul",null,[(0,e._)("li",null,"升级补丁版本号 npm version patch"),(0,e._)("li",null,"升级小版本号 npm version minor"),(0,e._)("li",null,"升级大版本号 npm version major 版本发布： npm publish")],-1),Tl=(0,e._)("p",null,"git规范和changelog生成 良好的 git commit规范优势：",-1),Nl=(0,e._)("ul",null,[(0,e._)("li",null,"加快code-review流程"),(0,e._)("li",null,"根据git commit的元数据生成changelog"),(0,e._)("li",null,"后续维护者可以知道feature被修改的原因")],-1),Ll=(0,e._)("p",null,"技术方案, 提交格式- 统一团队commit标准 extends angular-gitcommit 使用commitize工具，validate-commit-msg工具，gitlab serverhook， 使用conventional-changelog",-1),Ol=(0,e._)("p",null,"提交格式要求",-1),Al=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"<type>(<scope>): <subject>\n<BLANK LINE>\n<body>\n<BLANK LINE>\n<footer>\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br")])],-1),Il=(0,e._)("p",null,"type代表某次提交的类型",-1),Wl=(0,e._)("ul",null,[(0,e._)("li",null,"feat 新增feature"),(0,e._)("li",null,"fix 修复bug"),(0,e._)("li",null,"docs 仅仅修改了文档，比如README，CHANGELOG，CONTRIBUTE等等"),(0,e._)("li",null,"style 仅仅修改了空格，格式缩进，标点符号等，不改变代码逻辑"),(0,e._)("li",null,"refactor 代码重构，没有加新的功能或者修复bug"),(0,e._)("li",null,"perf 优化相关，比如提升性能、体验"),(0,e._)("li",null,"test 测试用例 包括单元测试 集成测试等"),(0,e._)("li",null,"chore 改变构建流程、或者增加依赖库 工具等"),(0,e._)("li",null,"rever 同GIT回滚")],-1),Dl=(0,e._)("p",null,"本地开发阶段增加preCommit钩子 安装husky 通过commitmsg钩子校验信息",-1),Rl=(0,e._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,e._)("pre",{class:"language-json"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"scripts"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token property"},'"commitmsg"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"validate-commit-msg"'),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token property"},'"changelog"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"conventional-changelog -p angular -i CHANGELOG.md -s -r 0"'),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},'"devDependencies"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token property"},'"validate-commit-msg"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},'"^2.11"'),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token property"},'"conventional-changelog-cli"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"^1.2"'),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token property"},'"husky"'),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"^0.13"'),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),Hl=(0,e._)("p",null,"开源项目版本信息案例",-1),zl=(0,e._)("ul",null,[(0,e._)("li",null,"软件的版本通常由三位组成，形如X.Y.Z"),(0,e._)("li",null,"版本是严格递增的"),(0,e._)("li",null,"在发布重要版本时，可以发布alpha,rc等先行版本"),(0,e._)("li",null,"aplha，rc等修饰版本的关键字后面可以带上次数和meta信息")],-1),Jl=(0,e._)("p",null,"遵守semsemver 规范的优势 避免出现循环依赖 依赖冲突减少",-1),Bl=(0,e._)("p",null,"语义化版本(Semantic Versioning)规范格式 主版本号： 当你做了不兼容的API修改 次版本号： 当你做了向下兼容的功能新增 修订号: 当你做了向下兼容的问题修正",-1),$l=(0,e._)("p",null,"先行版本号",-1),Gl=(0,e._)("p",null,"先行版本号可以作为发布正式版之前的版本，格式是在修订版本号后面加上一个连接号(-), 再加上一连串以点(.)分割的标识符，标识符可以由英文数字和连接号[0-9A-Za-z-]组成",-1),Fl=(0,e._)("ul",null,[(0,e._)("li",null,"alpha 是内部测试版，一般不向外发布，会有很多bug，一般只有测试人员使用。"),(0,e._)("li",null,"beta 也是测试版，这个阶段的版本不会一直加入新的功能，在Alpha版本之后推出"),(0,e._)("li",null,"rc Release Candidate 系统平台上就是发行候选版本。RC版本不会再加入新的功能了，主要着重于除错")],-1),Kl=(0,e._)("h3",{id:"_05-webpack构建速度和体积优化策略",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_05-webpack构建速度和体积优化策略","aria-hidden":"true"},"#"),(0,e.Uk)(" 05 Webpack构建速度和体积优化策略")],-1),Vl=(0,e._)("p",null,"初级分析：使用webpack内置的stats",-1),Zl=(0,e._)("p",null,[(0,e.Uk)("stats：构建的统计信息 package.json 中使用 stats "),(0,e._)("code",null,'"build:stats":"webpack --env production --json > stats.json"'),(0,e.Uk)(",")],-1),Xl=(0,e._)("p",null,"Node.js 使用",-1),Ql=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpack "),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" config "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.config.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'production'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"webpack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("config"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("stats")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"error"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("stats"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"hasErrors"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"error"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("stats"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"toString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'errors-only'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("stats"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),Yl=(0,e._)("p",null,"** 颗粒度太粗，看不出问题所在",-1),nt=(0,e._)("p",null,"速度分析： 使用speed-measure-webpack-plugin 代码示例",-1),st=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" SpeedMeasurePlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'speed-measure-webpack-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" smp "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"SpeedMeasurePlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpackConfig "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" smp"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"wrap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MyPugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MyOtherPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),at=(0,e._)("p",null,"可以看到每个loader和插件执行耗时",-1),et=(0,e._)("p",null,"速度分析插件作用 分析整个打包总耗时 每个插件和loader的耗时情况",-1),lt=(0,e._)("p",null,"webpack-bundle-analyzer 分析体积 代码示例",-1),tt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" BunldeAnalyzerPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-bundle-analyzer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("BundleAnalyzerPlugin"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"BundleAnalyzerPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),ot=(0,e._)("p",null,"构建完成后会在8888端口展示大小 可以分析哪些问题",-1),pt=(0,e._)("ul",null,[(0,e._)("li",null,"依赖的第三方模块文件大小"),(0,e._)("li",null,"业务里面的组件代码大小")],-1),ct=(0,e._)("p",null,"使用高版本的webpack和Node.js 构建时间降低了60%-98%；",-1),ut=(0,e._)("p",null,"使用webpack4 优化原因",-1),_t=(0,e._)("ul",null,[(0,e._)("li",null,"V8带来的优化（for of替代forEach Map Set替代Object includes替代indexOf）"),(0,e._)("li",null,"默认使用更快的md4 hash算法"),(0,e._)("li",null,"webpack AST可以直接从loader传递给AST，减少解析时间"),(0,e._)("li",null,"使用字符串方法替代正则表达式")],-1),it=(0,e._)("p",null,"多进程/多实例构建：资源并行解析可选方案 thread-loader 可选方案 parallel-webpack HappyPack 多进程/多实例：使用HappyPack解析资源 原理：每次webpack 解析一个模块，HappyPack会将它及它的依赖分配给worker线程中 代码示例",-1),rt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("exports"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("plugins"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HappyPack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        id"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'jsx'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        threads"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        loaders"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'babel-loader'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HappyPack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        id"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'styles'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        threads"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        loaders"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'style-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'css-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'less-loader'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br")])],-1),kt=(0,e._)("p",null,"多进程/多实例：使用thread-loader解析资源 原理：每次webpack解析一个模块 thread-loader会将它及它的依赖分配给worker线程中",-1),bt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" json"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},'"module.rules"'),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            test"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},".js$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            use"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    loader"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'thread-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                        workers"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"3"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token string"},"'babel-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token comment"},"// 'eslint-loader'"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br")])],-1),mt=(0,e._)("p",null,"多进程/多实例：并行压缩 方法一：使用parallel-uglify-plugin插件",-1),dt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" ParallelUglifyPlugin"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-parallel-uglify-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"ParallelUglifyPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            uglifyJS"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    beautify"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    comments"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                compress"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    warnings"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    drop_console"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    collapse_vars"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    reduce_vars"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br")])],-1),Ut=(0,e._)("p",null,"并行压缩 方法二：uglifyjs-webpack-plugin 开启parallel参数",-1),gt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" UglifyJsPlugin"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'uglifyjs-webpack-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"UglifyJsPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            uglifyOptions"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                warnings"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                parse"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                compress"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                mangle"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"null"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                toplevel"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                nameCache"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"null"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                ie8"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                keep_fnames"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            parallel"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br")])],-1),wt=(0,e._)("p",null,"并行压缩 方法三：terser-webpack-plugin 开启 parallel参数",-1),ht=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" TerserPlugin"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'terser-webpack-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    optimization"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        minimizer"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"TerserPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                parallel"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"4"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),vt=(0,e._)("p",null,"分包：设置Externals 思路：将 react、react-dom基础包 通过cdn引入，不打入bundle中 方法: 使用html-webpack-externals-plugin",-1),yt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"HtmlWebpackExternalsPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    externals"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'react'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'//11.url.cn/now/lib/15.1.0/react-with-addons.min.js?v=1'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            global"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'React'"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'react-dom'"),(0,e.Uk)("\n            entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'//11.url.cn/now/lib/15.1.0/react-dom.min.js?v=1'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            global"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'ReactDom'"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),ft=(0,e._)("p",null,"进一步设置分包：预编译资源模块 思路： 将react、react-dom、redux、react-redux基础包和业务基础包打成一个文件 方法：使用DLLPlugin 进行分包，DllReferencePlugin 对manifest.json引用",-1),xt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpack"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    context"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"cwd"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    resolve"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        extensions"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'.jsx'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'.json'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'.less'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'.css'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        modules"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'node_modules'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    entry"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        library"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'react'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'react-dom'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'redux'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'react-redux'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    output"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name].dll.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'./build/library'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        library"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name]'"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},[(0,e.Uk)("webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("DllPlugin")]),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name]'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./build/library/[name].json'"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br")])],-1),jt=(0,e._)("p",null,"在webpack.config.js引入",-1),St=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},[(0,e.Uk)("webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("DllReferencePlugin")]),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            manifest"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./build/library/manifest.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),Ct=(0,e._)("p",null,[(0,e.Uk)("引用效果 "),(0,e._)("code",null,'<script src="/build/library/library.dll.js"><\/script>')],-1),Pt=(0,e._)("p",null,"缓存 目的：提升二次构建速度 缓存思路： babel-loader 开启缓存 terser-webpack-plugin 开启缓存 使用cache-loader或者 hard-source-webpack-plugin",-1),Et=(0,e._)("p",null,[(0,e.Uk)("缩小构建目标 目的:尽可能的少构建模块 比如babel-loader不解析node_modules "),(0,e._)("code",null,"loader:'happypack/loader',exclude:'node_modules'")],-1),Mt=(0,e._)("p",null,"减少文件搜索范围 优化 resolve.modules设置（减少模块搜索层级） 优化resolve.mainFields 配置 优化 resolve.extensions 配置 合理使用alias",-1),qt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    resolve"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        alias"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            react"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'./node_modules/react/dist/react.min.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        modules"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'node_modules'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        extensions"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'.js'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        mainFields"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'main'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),Tt=(0,e._)("p",null,"图片压缩 要求：基于Node库的imagemin或者tinypng API 使用：配置image-webpack-loader",-1),Nt=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.(png|svg|jpg|gif|blob)$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    use"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'file-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("filename"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token string"},"img/[name]"),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("hash"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token string"},".[ext]"),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'image-webpack-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            mozjpeg"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("progresive"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("quality"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"65"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            optipng"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("enabled"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            pngquant"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("quality"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'65-90'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("speed"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            gifsicle"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("interlaced"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            webp"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("quality"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token number"},"75"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br")])],-1),Lt=(0,e._)("p",null,"Imagemin优点分析 有很多定制选项 可以引入更多第三方优化插件 例如pngquant 可以处理多种图片格式 压缩原理",-1),Ot=(0,e._)("ul",null,[(0,e._)("li",null,"pngquant: 是一款png压缩器，通过将图像转为具有alpha通道的更高效的8为PNG格式，可显著减少文件大小"),(0,e._)("li",null,"pngcrush： 其主要目的是通常尝试不同的压缩级别和PNG过滤方法来降低PNG IDAT数据流的大小"),(0,e._)("li",null,"optipng: 其设计灵感来自于pngcrush。optipng可将图像文件重新压缩为更小尺寸，而不是会丢失任何信息"),(0,e._)("li",null,"tinypng：也是将24位png文件转化为更小有索引的8位图片，同时所有非必要的metadata也会剥离掉")],-1),At=(0,e._)("h4",{id:"tree-shanking-复习",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#tree-shanking-复习","aria-hidden":"true"},"#"),(0,e.Uk)(" Tree Shanking（复习")],-1),It=(0,e._)("p",null,"概念： 1个模块可能有多个方法，只要其中的某个方法使用到了，则整个文件都会被打到 bundle 里面去，tressshaking就是把用到的方法打入bundle，没用到的方法会在uglify阶段被擦除掉",-1),Wt=(0,e._)("p",null,"使用webpack默认支持，在.babelrc里设置modules: false 即可 .production mode情况下默认开启 要求：必须是ES6语法，CJS的方式不支持",-1),Dt=(0,e._)("p",null,"无用的CSS如何删除掉 PurifyCSS便利代码，识别已经用到的CSS class uncss： HTML需要通过jsdom加载，所有的样式通过PostCSS解析，通过 document.querySelector来识别html文件里面不存在的选择器",-1),Rt=(0,e._)("p",null,"在webpack中如何使用PurifyCSS 使用purgress-webpack-plugin 和mini-css-extract-plugin配合使用 和mini-css-extract-plugin",-1),Ht=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MiniCssExtractPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            filename"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'[name].css'"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"PurgecssPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            paths"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" glob"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"sync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e._)("span",{class:"token constant"},"PATH"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("src"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token string"},"/**/*"),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("nodir"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e.Uk)("`"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br")])],-1),zt=(0,e._)("p",null,"构建体积优化动态polyfill babel-polyfill 打包后体积88.49K!!! Promise的浏览器支持情况",-1),Jt=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"方案"),(0,e._)("th",null,"优点"),(0,e._)("th",null,"缺点"),(0,e._)("th",null,"是否采用")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"babel-polyfill"),(0,e._)("td",null,"React官方推荐"),(0,e._)("td",null,"包体积大"),(0,e._)("td",null,"x")]),(0,e._)("tr",null,[(0,e._)("td",null,"babel-plugin-transform-runtime"),(0,e._)("td",null,"能只polyfill到方法"),(0,e._)("td",null,"不能polyfill原型上魔法"),(0,e._)("td",null,"x")]),(0,e._)("tr",null,[(0,e._)("td",null,"自己map，set的polyfill"),(0,e._)("td",null,"定制化高"),(0,e._)("td",null,"积小小"),(0,e._)("td",null,"x")]),(0,e._)("tr",null,[(0,e._)("td",null,"polyfill-service"),(0,e._)("td",null,"只给用户回需要的polyfill，社区维护"),(0,e._)("td",null,"部分国内UA挂"),(0,e._)("td",null,"☑️")])])],-1),Bt=(0,e._)("p",null,"Polyfill Service 原理 识别UserAgent 下发不同的Polyfill",-1),$t=(0,e._)("p",null,[(0,e.Uk)("构建体积优化：如何动态PolyfillService polyfill.io 官方提供的服务 "),(0,e._)("code",null,'<script src="https://cdn.polyfill.io/v2/polyfill.min.js"><\/script>')],-1),Gt=(0,e._)("p",null,"基于官方自建的polyfill服务",-1),Ft=(0,e._)("p",null,"体积优化策略总结",-1),Kt=(0,e._)("ul",null,[(0,e._)("li",null,"Scope Hoisting"),(0,e._)("li",null,"Tree Shaking"),(0,e._)("li",null,"公用资源分离"),(0,e._)("li",null,"图片压缩"),(0,e._)("li",null,"动态polyfill")],-1),Vt=(0,e._)("h3",{id:"_06-通过源码掌握webpack打包原理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#_06-通过源码掌握webpack打包原理","aria-hidden":"true"},"#"),(0,e.Uk)(" 06 通过源码掌握webpack打包原理")],-1),Zt=(0,e._)("p",null,"开始： 从webpack命令行说起 通过npm scripts运行 webpack",-1),Xt=(0,e._)("ul",null,[(0,e._)("li",null,"开发环境 npm run dev"),(0,e._)("li",null,"生产环境 npm run build")],-1),Qt=(0,e._)("p",null,"通过webpack直接运行",-1),Yt=(0,e._)("ul",null,[(0,e._)("li",null,"webpack entry.js bundle.js")],-1),no=(0,e._)("blockquote",null,[(0,e._)("p",null,"这个过程发生了什么")],-1),so=(0,e._)("p",null,[(0,e.Uk)("查找webpack入口文件 在命令行运行以上命令后，npm会让命令行工具 进入"),(0,e._)("code",null,"node_modules/.bin"),(0,e.Uk)(" 目录查找是否存在webpack.sh或者webpack.cmd文件，如果存在，就执行 不存在则抛出错误 实际入口文件是: node_modules/webpack/in/webpack.js")],-1),ao=(0,e._)("p",null,"分析webpack的入口文件: webpack.js",-1),eo=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exitCode "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"0"),(0,e.Uk)("；\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"runCommand"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("command"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("args")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"isInstalled"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token parameter"},"packagName"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" CLIs"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// webpack-command"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" installcides"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token constant"},"CLI"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"filter"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"cli"),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)("cli"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("installed"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("installedClis"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length"),(0,e._)("span",{class:"token operator"},"==="),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token operator"},"..."),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("installedClis"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length"),(0,e._)("span",{class:"token operator"},"==="),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),lo=(0,e._)("p",null,"启动后的结果 webpack最终找到 webpack-cli(webpack-command)这个 npm包 并且执行cli",-1),to=(0,e._)("p",null,"webpack-cli做的事情 引入yargs，对命令进行定制 分析命令行参数，对各个参数进行转换，组成编译配置项 引用webpack，根据配置项进行编译和构建",-1),oo=(0,e._)("p",null,"从NON_COMPILATION_CMD分析出不需要编译的命令 webpck-cli 处理不需要经过编译的命令",-1),po=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token constant"},"NON_COMPILATION_ARGS"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./utils/constants'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token constant"},"NON_COMPILATION_CMD"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"find"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"arg"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arg "),(0,e._)("span",{class:"token operator"},"==="),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'serve'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        global"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("precess"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("global"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"filter"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"a"),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)("a"),(0,e._)("span",{class:"token operator"},"!=="),(0,e._)("span",{class:"token string"},"'serve'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("global"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token constant"},"NON_COMPILATION_ARGS"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"find"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"a"),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)("a"),(0,e._)("span",{class:"token operator"},"==="),(0,e.Uk)("arg"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token constant"},"NON_COMPILATION_CMD"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./utils/prompt-command'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token constant"},"NON_COMPILATION_CMD"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token operator"},"..."),(0,e.Uk)("process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("argv"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),co=(0,e._)("p",null,[(0,e.Uk)("_ARGS 的内容 init // 创建一份webpack配置文件 migrate // 进行webpack版本迁移 add // 往webpack配置文件中增加属性 remove // 删除属性 serve // 运行webpack-serve generate-loader // 生成loader代码"),(0,e._)("br"),(0,e.Uk)(" generate-plugin // 生成plugin代码 info 返回与本地环境相关的一些信息")],-1),uo=(0,e._)("p",null,"命令行工具包yargs介绍",-1),_o=(0,e._)("p",null,"动态生成help 帮助信息",-1),io=(0,e._)("p",null,"webpack-cli使用args分析 参数分组(config/config-args.js),将命令划分为9类",-1),ro=(0,e._)("p",null,"config options 配置相关的参数 文件名称，运行环境等 basic options 基础参数 entry设置，debug模式，watch，devtool设置等 module options 模块参数，给loader 设置扩展 output options 输出参数（输出路径，输出文件名称 advacnded options 高级用法，记录设置，缓存设置，监听频率，bail等 resloving options 解析参数 alias和解析文件后缀 设置 optmization options 优化参数 status options 统计参数 options 通用参数 帮助命令 版本信息等",-1),ko=(0,e._)("p",null,"webpack-cli 执行结果 webpack-cli 对配置文件和命令行参数进行转换最终生成配置选项参数options 最终会根据配置参数实例化webpack对象，然后执行构建流程 webpack本质 webpack可以将其理解是一种基于事件流的编程规范，一系列的插件运行 先看一段代码 核心对象Compiler继承Tapable class Compiler extends Tapable{ // } 核心对象Compilation集成Tapable{ // } Tapable是什么？ Tapable是一个类似于Node.js的EventEmitter的库,主要是控制钩子的发布与订阅，控制这个webpack的插件系统 Tapable库暴露了很多Hooks ...",-1),bo=(0,e._)("h4",{id:"模拟compiler-js",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#模拟compiler-js","aria-hidden":"true"},"#"),(0,e.Uk)(" 模拟Compiler.js")],-1),mo=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token keyword"},"class"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Compiler"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"constructor"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hoos"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            accelerate"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"SyncHook"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'newspped'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            brake"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"SyncHook"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            calculateRoutes"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"AsyncSeriesHook"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'source'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'target'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'routesList'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"run"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"accerate"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"10"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"break"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"calculateRoutes"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'Async'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'hook'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'demo'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"accelerate"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"speed"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"accelerate"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("speed"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"break"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"brake"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"calculateRoutes"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("calculateRoutes"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"promise"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token operator"},"..."),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"then"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token parameter"},"err"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"lerror"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br")])],-1),Uo=(0,e._)("p",null,"插件 my-plugins.js",-1),go=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" Compiler"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./Compiler'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"class"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MyPlugin"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"constructor"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"compiler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        compiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("brake"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'WarningLampPlugin'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)("console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'WarningLampPlugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        compiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("accelerate"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'LoggerPlugin'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token parameter"},"newSpeed"),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)("console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},"Accelerating to "),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("newSpeed"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        compiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("calculateRoutes"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tapPromise"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'calculateRoutes tapAsync'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("source"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("target"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("routesList")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Promise"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("resolve"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("reject")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token function"},"setTimeout"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},"tapPromise to "),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("source"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("target"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token interpolation"},[(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,e.Uk)("routesList"),(0,e._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token function"},"reslove"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token number"},"1000"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br")])],-1),wo=(0,e._)("p",null,"模拟插件执行",-1),ho=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" myPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"MyPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" options"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("myPlugin"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" compiler"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Compiler"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"for"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" plugin "),(0,e._)("span",{class:"token keyword"},"of"),(0,e.Uk)(" options"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("plugins"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"typeof"),(0,e.Uk)(" plugin"),(0,e._)("span",{class:"token operator"},"==="),(0,e._)("span",{class:"token string"},"'function'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"plugin"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("compiler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("compiler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token keyword"},"else"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"plugin"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("compiler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\ncompiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"run"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),vo=(0,e._)("h4",{id:"webppack-流程篇",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#webppack-流程篇","aria-hidden":"true"},"#"),(0,e.Uk)(" Webppack 流程篇")],-1),yo=(0,e._)("p",null,"webpack的编译都按照下面的钩子调用顺序执行 *entry-option -> *run -> *make -> *before-resolve -> *build-module -> *normal-module-loader -> *program -> *seal -> *emit",-1),fo=(0,e._)("ol",null,[(0,e._)("li",null,"初始化 option"),(0,e._)("li",null,"开始编译"),(0,e._)("li",null,"从entry开始递归的分析依赖，对每个依赖模块进行build"),(0,e._)("li",null,"对模块位置进行解析"),(0,e._)("li",null,"开始构建某个模块"),(0,e._)("li",null,"将loader加载完成的module进行编译，生成AST树"),(0,e._)("li",null,"遍历AST树，当遇到require等一些调用表达式时，收集依赖"),(0,e._)("li",null,"所有依赖build完成，开始优化"),(0,e._)("li",null,"输出到dist目录")],-1),xo=(0,e._)("p",null,"WebpackOptionsApply 将所有的配置options参数转换成 webpack内部插件 使用默认插件列表 举例:",-1),jo=(0,e._)("ul",null,[(0,e._)("li",null,"outpu.library->LibraryTemplatePlugin"),(0,e._)("li",null,"externals->ExternalsPlugin"),(0,e._)("li",null,"devtool->EvalDevtoolModulePlugin,SourceMapDevToolPlugin"),(0,e._)("li",null,"AMDPlugin,CommonJsPlugin"),(0,e._)("li",null,"RemoveEmptyChunksPlugin")],-1),So=(0,e._)("p",null,"Compiler Hooks 流程相关：",-1),Co=(0,e._)("ul",null,[(0,e._)("li",null,"before-)run"),(0,e._)("li",null,"before-/after-)compile"),(0,e._)("li",null,"make"),(0,e._)("li",null,"after-)emit"),(0,e._)("li",null,"done 监听相关:"),(0,e._)("li",null,"watch-run"),(0,e._)("li",null,"watch-close")],-1),Po=(0,e._)("p",null,"Compilation Compiler调用Compilation生命周期方法",-1),Eo=(0,e._)("ul",null,[(0,e._)("li",null,"addEntry -> addModuleChain"),(0,e._)("li",null,"finish(上报模块错误)"),(0,e._)("li",null,"seal")],-1),Mo=(0,e._)("p",null,"ModuleFactory",-1),qo=(0,e._)("ul",null,[(0,e._)("li",null,"NormalModuleFactory"),(0,e._)("li",null,"ContextModuleFactory Module"),(0,e._)("li",null,"NormalModule"),(0,e._)("li",null,"ContextModule(./src/*)"),(0,e._)("li",null,"ExternalModule(module.exports=jQuery)"),(0,e._)("li",null,"DelegatedModule(manifest)")],-1),To=(0,e._)("p",null,"NormalModule Build",-1),No=(0,e._)("ul",null,[(0,e._)("li",null,"使用loader-runner运行loaders"),(0,e._)("li",null,"通过Parse解析(内部是acron)"),(0,e._)("li",null,"ParsePlugins添加依赖")],-1),Lo=(0,e._)("p",null,"Compilation hooks 模块相关",-1),Oo=(0,e._)("ul",null,[(0,e._)("li",null,"build-module"),(0,e._)("li",null,"failed-module"),(0,e._)("li",null,"succeed-module 优化相关："),(0,e._)("li",null,"after-)seal"),(0,e._)("li",null,"optimize"),(0,e._)("li",null,"optimize-modules(-basic/advanced)"),(0,e._)("li",null,"after-optimize-modules"),(0,e._)("li",null,"after-optimize-chunks"),(0,e._)("li",null,"after-optimize-tree"),(0,e._)("li",null,"optimize-chunk-modules(-basic/advanced)")],-1),Ao=(0,e._)("p",null,"资源生成相关：",-1),Io=(0,e._)("ul",null,[(0,e._)("li",null,"module-asset"),(0,e._)("li",null,"chunk-asset")],-1),Wo=(0,e._)("p",null,"Chunk 生成算法",-1),Do=(0,e._)("ol",null,[(0,e._)("li",null,"webpack先将entry中对应的module都生成一个新的chunk"),(0,e._)("li",null,"遍历module的依赖列表，将依赖的module也加入到chunk中"),(0,e._)("li",null,"如果一个依赖module是动态引入的模块，那么就会根据这个module创建一个新的chunk，继续遍历依赖"),(0,e._)("li",null,"重复上面的过程直至得到所有的chunks")],-1),Ro=(0,e._)("p",null,"模块化：增加代码可读性和维护性 传统的网页开发转变成WebApps开发 代码复杂度在逐步增高 分离的JS文件/模块，便于后续代码的维护性 部署时希望把代码优化成几个HTTP请求",-1),Ho=(0,e._)("p",null,"常见的集中模块化方式 ES module CJS AMD",-1),zo=(0,e._)("p",null,"AST 基础知识 抽象语法树(abstract syntax tree),或者语法树(syntax tree),是源代码的抽象语法结构的树状表现形式,这里特指编程语言的源代码，树上的每个节点都表示源代码中的一种结构",-1),Jo=(0,e._)("h4",{id:"复习一下webpack的模块机制",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#复习一下webpack的模块机制","aria-hidden":"true"},"#"),(0,e.Uk)(" 复习一下webpack的模块机制")],-1),Bo=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"modules"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" installedModules"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"__webpack_require__"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"moduleId"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("installedModules"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("moduleId"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" installedModules"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("moduleId"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" module "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" installedModules"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("moduleId"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            i"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" moduleId"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            l"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            exports"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        modules"),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("moduleId"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("__webpack_require__"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("l"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" module"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"__webpack_require__"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"0"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"/* 0 module */"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("module"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("__webpack_exports__"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("__webpack_require__")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// ..."),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"/* 1 module */"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br")])],-1),$o=(0,e._)("ul",null,[(0,e._)("li",null,"打包出来的是一个 IIFE（匿名闭包)"),(0,e._)("li",null,"modules 是一个数组，每一项是一个模块初始化函数"),(0,e._)("li",null,"__webpack_require用来加载模块，返回module.exports"),(0,e._)("li",null,"通过WEBPACK_REQUIRE_METHOD(0) 启动程序")],-1),Go=(0,e._)("p",null,"动手实现一个简易的webpack",-1),Fo=(0,e._)("ol",null,[(0,e._)("li",null,[(0,e.Uk)("可以将ES6语法转换成ES5的语法 "),(0,e._)("ul",null,[(0,e._)("li",null,"通过babylon 生成AST"),(0,e._)("li",null,"通过babel-core将AST重新生成源码")])]),(0,e._)("li",null,[(0,e.Uk)("可以分析模块之间的依赖关系 "),(0,e._)("ul",null,[(0,e._)("li",null,"通过babel-traverse 的 ImportDeclaration方法获取依赖属性")])]),(0,e._)("li",null,"生成的JS文件可以在浏览器中运行")],-1),Ko={},Vo=(0,a(3744).Z)(Ko,[["render",function(n,s){const a=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t,(0,e._)("nav",o,[(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(a,{to:"#original"},{default:(0,e.w5)((()=>[p])),_:1}),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(a,{to:"#concepts"},{default:(0,e.w5)((()=>[c])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#entry"},{default:(0,e.w5)((()=>[u])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#output"},{default:(0,e.w5)((()=>[_])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#plugins"},{default:(0,e.w5)((()=>[i])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#mode"},{default:(0,e.w5)((()=>[r])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#browser-compatibility"},{default:(0,e.w5)((()=>[k])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#scenarios"},{default:(0,e.w5)((()=>[b])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#multiple-entry-points"},{default:(0,e.w5)((()=>[m])),_:1})])])]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#webpack内容综述"},{default:(0,e.w5)((()=>[d])),_:1}),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_01-webpack与构建发展简史"},{default:(0,e.w5)((()=>[U])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_02-webpack基础用法"},{default:(0,e.w5)((()=>[g])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_03-webpack进阶用法"},{default:(0,e.w5)((()=>[w])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_04-编写可维护的webpack构建配置"},{default:(0,e.w5)((()=>[h])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_05-webpack构建速度和体积优化策略"},{default:(0,e.w5)((()=>[v])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(a,{to:"#_06-通过源码掌握webpack打包原理"},{default:(0,e.w5)((()=>[y])),_:1})])])])])]),f,x,j,S,C,P,E,M,q,T,N,L,O,A,I,W,D,R,H,z,J,B,$,G,F,K,V,Z,X,Q,Y,nn,sn,an,en,ln,tn,on,pn,cn,un,_n,rn,kn,bn,mn,dn,Un,gn,wn,hn,vn,yn,fn,xn,jn,Sn,Cn,Pn,En,Mn,qn,Tn,Nn,Ln,On,An,In,Wn,Dn,Rn,Hn,zn,Jn,Bn,$n,Gn,Fn,Kn,Vn,Zn,Xn,Qn,Yn,ns,ss,as,es,ls,ts,os,ps,cs,us,_s,is,rs,ks,bs,ms,ds,Us,gs,ws,hs,vs,ys,fs,xs,js,Ss,Cs,Ps,Es,Ms,qs,Ts,Ns,Ls,Os,As,Is,Ws,Ds,Rs,Hs,zs,Js,Bs,$s,Gs,Fs,Ks,Vs,Zs,Xs,Qs,Ys,na,sa,aa,ea,la,ta,oa,pa,ca,ua,_a,ia,ra,ka,ba,ma,da,Ua,ga,wa,ha,va,ya,fa,xa,ja,Sa,Ca,Pa,Ea,Ma,qa,Ta,Na,La,Oa,Aa,Ia,Wa,Da,Ra,Ha,za,Ja,Ba,$a,Ga,Fa,Ka,Va,Za,Xa,Qa,Ya,ne,se,ae,ee,le,te,oe,pe,ce,ue,_e,ie,re,ke,be,me,de,Ue,ge,we,he,ve,ye,fe,xe,je,Se,Ce,Pe,Ee,Me,qe,Te,Ne,Le,Oe,Ae,Ie,We,De,Re,He,ze,Je,Be,$e,Ge,Fe,Ke,Ve,Ze,Xe,Qe,Ye,nl,sl,al,el,ll,tl,ol,pl,cl,ul,_l,il,rl,kl,bl,ml,dl,Ul,gl,wl,hl,vl,yl,fl,xl,jl,Sl,Cl,Pl,El,Ml,ql,Tl,Nl,Ll,Ol,Al,Il,Wl,Dl,Rl,Hl,zl,Jl,Bl,$l,Gl,Fl,Kl,Vl,Zl,Xl,Ql,Yl,nt,st,at,et,lt,tt,ot,pt,ct,ut,_t,it,rt,kt,bt,mt,dt,Ut,gt,wt,ht,vt,yt,ft,xt,jt,St,Ct,Pt,Et,Mt,qt,Tt,Nt,Lt,Ot,At,It,Wt,Dt,Rt,Ht,zt,Jt,Bt,$t,Gt,Ft,Kt,Vt,Zt,Xt,Qt,Yt,no,so,ao,eo,lo,to,oo,po,co,uo,_o,io,ro,ko,bo,mo,Uo,go,wo,ho,vo,yo,fo,xo,jo,So,Co,Po,Eo,Mo,qo,To,No,Lo,Oo,Ao,Io,Wo,Do,Ro,Ho,zo,Jo,Bo,$o,Go,Fo],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}},744:(n,s,a)=>{n.exports=a.p+"assets/img/HMR-principal.0552d93f.png"}}]);